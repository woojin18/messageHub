<?xml version="1.0" encoding="UTF-8"?>
<configuration status="DEBUG" >
    <Properties>
        <Property name="app-name">cm-web-console</Property>
        <Property name="log-path">logs/web-console</Property>
        <Property name="log-path-efs">efs/logs/web-console</Property>
    </Properties>
    <appenders>
        <Console name="console" >
            <!-- <MarkerFilter marker="PRIVACY" onMatch="DENY" onMismatch="ACCEPT"/> --> <!-- 개인정보 마커필터 qa 이후 주석처리 -->
            <PatternLayout pattern="%d{yyyy-MM-dd HH:mm:ss.SSS} [${app-name}] [%15.15t] %5p [%-30.30logger{1.}] (%-4L) : %m%n%wEx" />
        </Console>

        <RollingFile name="service_file" fileName="${log-path}/service/${hostName}.log" filePattern="${log-path}/service/%d{yyyyMMdd}/${hostName}-%i.log">
            <MarkerFilter marker="PRIVACY" onMatch="DENY" onMismatch="ACCEPT"/>
            <PatternLayout pattern="%d{yyyy-MM-dd HH:mm:ss.SSS} [${app-name}] [%15.15t] %5p [%-30.30logger{1.}] (%-4L) : %m%n%wEx" />
            <Policies>
                <SizeBasedTriggeringPolicy size="500MB" /> <!-- 이 용량이 초과되면 아래 DefaultRolloverStrategy 정책만큼 넘버링  -->
                <TimeBasedTriggeringPolicy /><!-- Rotated everyday -->
            </Policies>
            <DefaultRolloverStrategy max="500" fileIndex="min" />
        </RollingFile>

        <RollingFile name="access_file" fileName="${log-path}/access/${hostName}-access.log" filePattern="${log-path}/access/%d{yyyyMMdd}/${hostName}-access-%i.log">
            <MarkerFilter marker="PRIVACY" onMatch="DENY" onMismatch="ACCEPT"/>
            <PatternLayout pattern="%d{yyyy-MM-dd HH:mm:ss.SSS} [%15.15t] %5p [%-30.30logger{1.}] (%-4L) : %m%n%wEx" />
            <Policies>
                <SizeBasedTriggeringPolicy size="500MB" /> <!-- 이 용량이 초과되면 아래 DefaultRolloverStrategy 정책만큼 넘버링  -->
                <TimeBasedTriggeringPolicy /><!-- Rotated everyday -->
            </Policies>
            <DefaultRolloverStrategy max="500" fileIndex="min" />
        </RollingFile>

        <RollingFile name="alive_file" fileName="${log-path-efs}/alive/${hostName}-alive.log" filePattern="${log-path-efs}/alive/%d{yyyyMMdd}/${hostName}-alive-%i.log">
            <MarkerFilter marker="PRIVACY" onMatch="DENY" onMismatch="ACCEPT"/>
            <PatternLayout pattern="%d{yyyy-MM-dd HH:mm:ss.SSS} %m%n%wEx" />
            <Policies>
                <SizeBasedTriggeringPolicy size="500MB" /> <!-- 이 용량이 초과되면 아래 DefaultRolloverStrategy 정책만큼 넘버링  -->
                <TimeBasedTriggeringPolicy /><!-- Rotated everyday -->
            </Policies>
            <DefaultRolloverStrategy max="500" fileIndex="min" />
        </RollingFile>

        <RollingFile name="error_file" fileName="${log-path-efs}/error/${app-name}.log" filePattern="${log-path-efs}/error/$${date:yyyyMMdd}/${app-name}.log">
            <MarkerFilter marker="PRIVACY" onMatch="DENY" onMismatch="ACCEPT"/>
            <PatternLayout pattern="%d{yyyy-MM-dd HH:mm:ss.SSS} [${hostName}] [%20.20t] [%-40.40logger{39}] (%-4L) : %m%n%wEx" />
            <Policies>
                <CronTriggeringPolicy schedule="0 0 0 * * ?" />
            </Policies>
        </RollingFile>

        <RollingFile name="trace_file" fileName="${log-path}/trace/${hostName}-trace.log" filePattern="${log-path}/trace/%d{yyyyMMdd}/${hostName}-trace-%i.log">
            <JsonLayout complete="false" compact="true" eventEol="true" stacktraceAsString="false" objectMessageAsJsonObject="true" />
            <Policies>
                <SizeBasedTriggeringPolicy size="500MB" /> <!-- 이 용량이 초과되면 아래 DefaultRolloverStrategy 정책만큼 넘버링 -->
                <TimeBasedTriggeringPolicy /><!-- Rotated everyday -->
            </Policies>
            <DefaultRolloverStrategy max="500" fileIndex="min" />
        </RollingFile>

    </appenders>

    <loggers>
        <root level="debug" >
            <appender-ref ref="service_file" />
            <appender-ref ref="error_file" level="error" />
            <appender-ref ref="console" level="info" />
        </root>

        <logger name="kr.co.uplus.rcs.common.cmd.HealthCheckCmd" >
            <appender-ref ref="alive_file" />
        </logger>
        
        <logger name="kr.co.uplus.cm.common.jwt.JwtExceptionFilter" level="info">
            <appender-ref ref="trace_file" />
        </logger>

        <logger name="org.apache" level="info" />
        <logger name="org.springframework" level="info" />
        <logger name="io.lettuce.core" level="info" />
        <logger name="org.mybatis" level="OFF" />
        <logger name="io.netty" level="info" />

        <!-- DB 관련 -->
        <logger name="jdbc" level="OFF"/>
        <logger name="jdbc.sqlonly" level="OFF" />
        <logger name="jdbc.sqltiming" level="OFF" />
        <logger name="jdbc.audit" level="OFF" />
        <logger name="jdbc.resultset" level="OFF" />
        <logger name="jdbc.resultsettable" level="OFF" />
        <logger name="jdbc.connection" level="OFF" />
        <logger name="org.mongodb.driver" level="OFF"/>

    </loggers>
</configuration>