<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="integratedTemplate">

    <sql id ="whereSelectIntegratedTemplateList">
        <!-- AND A.CORP_ID = #{corpId} -->
        AND A.TMPLT_TYPE = 'M'
		AND (A.PROJECT_ID = #{projectId} || A.PROJECT_ID = 'ALL')
        <if test="searchText != '' and searchText != null ">
            AND A.TMPLT_TITLE = CONCAT('%', #{searchText}, '%')
        </if>
        <if test="searchStartDate != '' and searchStartDate != null ">
            <if test="searchEndDate != '' and searchEndDate != null ">
            AND A.REG_DT BETWEEN CONCAT(#{searchStartDate}, ' 00:00:00') AND CONCAT(#{searchEndDate}, ' 23:59:59')
            </if>
        </if>
    </sql>

    <select id="selectIntegratedTemplateListCnt" parameterType="hashmap" resultType="int">
    /* 통합발송 템플릿 카운트 조회 */
        SELECT
            COUNT(PROJECT_ID) AS CNT
        FROM cm.CM_SMART_TMPLT A
        WHERE 1=1
        <include refid="whereSelectIntegratedTemplateList"/>
    </select>

    <select id="selectIntegratedTemplateList" parameterType="hashmap" resultType="camel">
    /* 통합발송 템플릿 리스트 조회 */
		SELECT  @rownum:=@rownum+1 AS ROW_NUM
		      , A.PROJECT_ID
		      , CASE WHEN A.PROJECT_ID = 'ALL' THEN 'Y'
		             ELSE 'N'
		        END AS otherProjectUseYn
		      , A.TMPLT_CODE
		      , A.MSG_KIND
		      , CASE WHEN A.MSG_KIND = 'I' THEN '정보성'
		             WHEN A.MSG_KIND = 'A' THEN '광고성'
		        END AS MSG_KIND_NAME
		      , A.MSG_TYPE
		       , CASE WHEN A.MSG_TYPE = 'IMAGE' THEN '텍스트'
		             WHEN A.MSG_TYPE = 'BASE' THEN '이미지'
		        END AS MSG_TYPE_NAME
		      , A.TMPLT_TITLE
		      , A.TMPLT_INFO
		      , A.TMPLT_TYPE
		      , A.USE_YN
		      , A.TMPLT_INFO ->> '$[0].chTypeList' AS TMPLT_CHANNEL
		      , JSON_EXTRACT(A.TMPLT_INFO, '$[*].chType') CHECKED_CHANNEL
		      , REG_ID
		      , REG_DT
		FROM cm.CM_SMART_TMPLT A
		   , (SELECT @rownum:=0) TMP
		WHERE 1=1
		<include refid="whereSelectIntegratedTemplateList"/>
		ORDER BY A.REG_DT DESC
        <if test='pagingYn == "Y" '>
        LIMIT ${offset}, #{listSize}
        </if>
    </select>


    <select id="selectIntegratedTemplateDetail" parameterType="hashmap" resultType="camel">
    /* 통합발송 템플릿 상세 조회 */
SELECT T.PROJECT_ID, T.TMPLT_CODE, T.MSG_KIND, T.MSG_KIND_NAME, T.MSG_TYPE
     , T.MSG_TYPE_NAME, T.TMPLT_TITLE, T.TMPLT_INFO, T.TMPLT_TYPE, T.otherProjectUseYn
     , T.USE_YN, T.chTypeList, T.CHECKED_CHANNEL
		      
	 , T.pushMsg, T.pushAppId, T.pushTitle, T.pushFileId, T.pushSendType, T.pushRcvblcInput
	  
	 , @PUSH_PATH_TO_NAME := JSON_UNQUOTE(JSON_SEARCH(B.USE_CH_INFO, "one", 'PUSH', NULL, '$[*].CH')) AS PUSH_PATH_TO_NAME
     , @PUSH_PATH_TO_PARENT := TRIM(TRAILING '.CH' FROM @PUSH_PATH_TO_NAME) AS PUSH_PATH_TO_PARENT
     , @PUSH_CH_OBJECT := JSON_EXTRACT(B.USE_CH_INFO, @PUSH_PATH_TO_PARENT) AS PUSH_CH_OBJECT
     , @PUSH_CH_IMG_URL := JSON_UNQUOTE(JSON_EXTRACT(@PUSH_CH_OBJECT, '$.URL')) AS PUSH_CH_IMG_URL
			   	
	 , T.rcsBodyMedia, T.rcsBodyTitle, T.rcsBodyDescription, T.rcsPrdType, T.rcsCallback, T.rcsMessageBaseId, T.rcsFooter
	 , CASE WHEN rcsBodyMediaUrl = '{}' then ''
	        ELSE T.rcsBodyMediaUrl
	        END AS rcsBodyMediaUrl
			   	
	 , T.rcsButton0Data, T.rcsButton0ButtonType, T.rcsButton0DisplayText, T.rcsButton0Title, T.rcsButton0StartTime, T.rcsButton0EndTime, T.rcsButton0Description
	 , CASE WHEN T.rcsButton0StartTime != '' THEN 'rcsStartDateId0' ELSE '' END AS rcsButton0StartTimeId
	 , CASE WHEN T.rcsButton0EndTime   != '' THEN 'rcsEndDateId0'   ELSE '' END AS rcsButton0EndTimeId
	 , T.rcsButton1Data, T.rcsButton1ButtonType, T.rcsButton1DisplayText, T.rcsButton1Title, T.rcsButton1StartTime, T.rcsButton1EndTime, T.rcsButton1Description
	 , CASE WHEN T.rcsButton1StartTime != '' THEN 'rcsStartDateId1' ELSE '' END AS rcsButton1StartTimeId
	 , CASE WHEN T.rcsButton1EndTime   != '' THEN 'rcsEndDateId1'   ELSE '' END AS rcsButton1EndTimeId
	 , T.rcsButton2Data, T.rcsButton2ButtonType, T.rcsButton2DisplayText, T.rcsButton2Title, T.rcsButton2StartTime, T.rcsButton2EndTime, T.rcsButton2Description	
	 , CASE WHEN T.rcsButton2StartTime != '' THEN 'rcsStartDateId2' ELSE '' END AS rcsButton2StartTimeId
	 , CASE WHEN T.rcsButton2EndTime   != '' THEN 'rcsEndDateId2'   ELSE '' END AS rcsButton2EndTimeId		   	
		      
	 , T.rcsButton3Data, T.rcsButton3ButtonType, T.rcsButton3DisplayText, T.rcsButton3Title, T.rcsButton3StartTime, T.rcsButton3EndTime, T.rcsButton3Description
	 , CASE WHEN T.rcsButton3StartTime != '' THEN 'rcsStartDateId3' ELSE '' END AS rcsButton3StartTimeId
	 , CASE WHEN T.rcsButton3EndTime   != '' THEN 'rcsEndDateId3'   ELSE '' END AS rcsButton3EndTimeId
	 , T.rcsButton4Data, T.rcsButton4ButtonType, T.rcsButton4DisplayText, T.rcsButton4Title, T.rcsButton4StartTime, T.rcsButton4EndTime, T.rcsButton4Description
	 , CASE WHEN T.rcsButton4StartTime != '' THEN 'rcsStartDateId4' ELSE '' END AS rcsButton4StartTimeId
	 , CASE WHEN T.rcsButton4EndTime   != '' THEN 'rcsEndDateId4'   ELSE '' END AS rcsButton4EndTimeId
	 , T.rcsButton5Data, T.rcsButton5ButtonType, T.rcsButton5DisplayText, T.rcsButton5Title, T.rcsButton5StartTime, T.rcsButton5EndTime, T.rcsButton5Description
	 , CASE WHEN T.rcsButton5StartTime != '' THEN 'rcsStartDateId5' ELSE '' END AS rcsButton5StartTimeId
	 , CASE WHEN T.rcsButton5EndTime   != '' THEN 'rcsEndDateId5'   ELSE '' END AS rcsButton5xEndTimeId
	 
	  
	 , T.friendTalkSenderKey, T.friendTalkWideImageYn, T.friendTalkContent, T.friendTalkFileId, T.friendTalkImgUrl, T.friendTalkImageLink
	 , T.friendTalkButton0ButtonType, T.friendTalkButton0DisplayText, T.friendTalkButton0Title, T.friendTalkButton0StartTime, T.friendTalkButton0EndTime, T.friendTalkButton0Description
	 , CASE WHEN T.friendTalkButton0StartTime != '' THEN 'friendTalkStartDateId0' ELSE '' END AS friendTalkButton0StartTimeId
	 , CASE WHEN T.friendTalkButton0EndTime   != '' THEN 'friendTalkEndDateId0'   ELSE '' END AS friendTalkButton0EndTimeId
	 , T.friendTalkButton1ButtonType, T.friendTalkButton1DisplayText, T.friendTalkButton1Title, T.friendTalkButton1StartTime, T.friendTalkButton1EndTime, T.friendTalkButton1Description
	 , CASE WHEN T.friendTalkButton1StartTime != '' THEN 'friendTalkStartDateId1' ELSE '' END AS friendTalkButton1StartTimeId
	 , CASE WHEN T.friendTalkButton1EndTime   != '' THEN 'friendTalkEndDateId1'   ELSE '' END AS friendTalkButton1EndTimeId
	 , T.friendTalkButton2ButtonType, T.friendTalkButton2DisplayText, T.friendTalkButton2Title, T.friendTalkButton2StartTime, T.friendTalkButton2EndTime, T.friendTalkButton2Description
	 , CASE WHEN T.friendTalkButton2StartTime != '' THEN 'friendTalkStartDateId2' ELSE '' END AS friendTalkButton2StartTimeId
	 , CASE WHEN T.friendTalkButton2EndTime   != '' THEN 'friendTalkEndDateId2'   ELSE '' END AS friendTalkButton2EndTimeId
	 , T.friendTalkButton3ButtonType, T.friendTalkButton3DisplayText, T.friendTalkButton3Title, T.friendTalkButton3StartTime, T.friendTalkButton3EndTime, T.friendTalkButton3Description
	 , CASE WHEN T.friendTalkButton3StartTime != '' THEN 'friendTalkStartDateId3' ELSE '' END AS friendTalkButton3StartTimeId
	 , CASE WHEN T.friendTalkButton3EndTime   != '' THEN 'friendTalkEndDateId3'   ELSE '' END AS friendTalkButton3EndTimeId
	 , T.friendTalkButton4ButtonType, T.friendTalkButton4DisplayText, T.friendTalkButton4Title, T.friendTalkButton4StartTime, T.friendTalkButton4EndTime, T.friendTalkButton4Description
	 , CASE WHEN T.friendTalkButton4StartTime != '' THEN 'friendTalkStartDateId4' ELSE '' END AS friendTalkButton4StartTimeId
	 , CASE WHEN T.friendTalkButton4EndTime   != '' THEN 'friendTalkEndDateId4'   ELSE '' END AS friendTalkButton4EndTimeId
	  
	 , T.smsSendType, T.smsCallback, T.smsContent, T.smsTitle, T.smsFileId0, T.smsFileId1

     
	 , @MMS_PATH_TO_NAME0 := JSON_UNQUOTE(JSON_SEARCH(sms1.USE_CH_INFO, "one", 'MMS', NULL, '$[*].CH')) AS MMS_PATH_TO_NAME0
     , @MMS_PATH_TO_PARENT0 := TRIM(TRAILING '.CH' FROM @MMS_PATH_TO_NAME0) AS MMS_PATH_TO_PARENT0
     , @MMS_CH_OBJECT0 := JSON_EXTRACT(sms1.USE_CH_INFO, @MMS_PATH_TO_PARENT0) AS MMS_CH_OBJECT0
     , @MMS_CH_IMG_URL0 := JSON_UNQUOTE(JSON_EXTRACT(@MMS_CH_OBJECT0, '$.URL')) AS MMS_CH_IMG_URL0
	  	
	 , @MMS_PATH_TO_NAME1 := JSON_UNQUOTE(JSON_SEARCH(sms1.USE_CH_INFO, "one", 'MMS', NULL, '$[*].CH')) AS MMS_PATH_TO_NAME1
     , @MMS_PATH_TO_PARENT1 := TRIM(TRAILING '.CH' FROM @MMS_PATH_TO_NAME1) AS MMS_PATH_TO_PARENT1
     , @MMS_CH_OBJECT1 := JSON_EXTRACT(sms1.USE_CH_INFO, @MMS_PATH_TO_PARENT1) AS MMS_CH_OBJECT1
     , @MMS_CH_IMG_URL1 := JSON_UNQUOTE(JSON_EXTRACT(@MMS_CH_OBJECT1, '$.URL')) AS MMS_CH_IMG_URL1

FROM (		
        SELECT A.PROJECT_ID
		      , A.TMPLT_CODE
		      , A.MSG_KIND
		      , CASE WHEN A.MSG_KIND = 'I' THEN '정보성'
		             WHEN A.MSG_KIND = 'A' THEN '광고성'
		        END AS MSG_KIND_NAME
		      , A.MSG_TYPE
		      , CASE WHEN A.MSG_TYPE = 'IMAGE' THEN '텍스트'
		             WHEN A.MSG_TYPE = 'BASE' THEN '이미지'
		        END AS MSG_TYPE_NAME
		      , A.TMPLT_TITLE
		      , A.TMPLT_INFO
		      , A.TMPLT_TYPE
		      , CASE WHEN  A.PROJECT_ID = 'ALL' THEN 'Y'
		             ELSE 'N'
		             END AS otherProjectUseYn
		      , A.USE_YN
		      , A.TMPLT_INFO ->> '$[0].chTypeList' AS chTypeList
		      , REPLACE(REPLACE(REPLACE(JSON_EXTRACT(A.TMPLT_INFO, '$[*].chType'),'[',''),']',''),'"','') CHECKED_CHANNEL
		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'Push' then A.TMPLT_INFO ->> '$[0].msg'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'Push' then A.TMPLT_INFO ->> '$[1].msg'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'Push' then A.TMPLT_INFO ->> '$[2].msg'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'Push' then A.TMPLT_INFO ->> '$[3].msg'
			        	 ELSE ''
			   	END AS pushMsg

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'Push' then A.TMPLT_INFO ->> '$[0].appId'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'Push' then A.TMPLT_INFO ->> '$[1].appId'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'Push' then A.TMPLT_INFO ->> '$[2].appId'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'Push' then A.TMPLT_INFO ->> '$[3].appId'
			        	 ELSE ''
			   	END AS pushAppId

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'Push' then A.TMPLT_INFO ->> '$[0].title'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'Push' then A.TMPLT_INFO ->> '$[1].title'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'Push' then A.TMPLT_INFO ->> '$[2].title'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'Push' then A.TMPLT_INFO ->> '$[3].title'
			        	 ELSE ''
			   	END AS pushTitle

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'Push' then A.TMPLT_INFO ->> '$[0].fileId'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'Push' then A.TMPLT_INFO ->> '$[1].fileId'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'Push' then A.TMPLT_INFO ->> '$[2].fileId'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'Push' then A.TMPLT_INFO ->> '$[3].fileId'
			        	 ELSE ''
			   	END AS pushFileId

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'Push' then A.TMPLT_INFO ->> '$[0].sendType'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'Push' then A.TMPLT_INFO ->> '$[1].sendType'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'Push' then A.TMPLT_INFO ->> '$[2].sendType'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'Push' then A.TMPLT_INFO ->> '$[3].sendType'
			        	 ELSE ''
			   	END AS pushSendType	

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'Push' then A.TMPLT_INFO ->> '$[0].rcvblcInput'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'Push' then A.TMPLT_INFO ->> '$[1].rcvblcInput'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'Push' then A.TMPLT_INFO ->> '$[2].rcvblcInput'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'Push' then A.TMPLT_INFO ->> '$[3].rcvblcInput'
			        	 ELSE ''
			   	END AS pushRcvblcInput																													   	

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' then A.TMPLT_INFO ->> '$[0].body[0].media'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' then A.TMPLT_INFO ->> '$[1].body[0].media'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' then A.TMPLT_INFO ->> '$[2].body[0].media'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' then A.TMPLT_INFO ->> '$[3].body[0].media'
			        	 ELSE ''
			   	END AS rcsBodyMedia	
			   	
		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' then A.TMPLT_INFO ->> '$[0].body[0].mediaUrl'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' then A.TMPLT_INFO ->> '$[1].body[0].mediaUrl'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' then A.TMPLT_INFO ->> '$[2].body[0].mediaUrl'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' then A.TMPLT_INFO ->> '$[3].body[0].mediaUrl'
			        	 ELSE ''
			   	END AS rcsBodyMediaUrl				   	

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' then A.TMPLT_INFO ->> '$[0].body[0].title'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' then A.TMPLT_INFO ->> '$[1].body[0].title'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' then A.TMPLT_INFO ->> '$[2].body[0].title'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' then A.TMPLT_INFO ->> '$[3].body[0].title'
			        	 ELSE ''
			   	END AS rcsBodyTitle				   	

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' then A.TMPLT_INFO ->> '$[0].body[0].description'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' then A.TMPLT_INFO ->> '$[1].body[0].description'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' then A.TMPLT_INFO ->> '$[2].body[0].description'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' then A.TMPLT_INFO ->> '$[3].body[0].description'
			        	 ELSE ''
			   	END AS rcsBodyDescription

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' then A.TMPLT_INFO ->> '$[0].rcsPrdType'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' then A.TMPLT_INFO ->> '$[1].rcsPrdType'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' then A.TMPLT_INFO ->> '$[2].rcsPrdType'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' then A.TMPLT_INFO ->> '$[3].rcsPrdType'
			        	 ELSE ''
			   	END AS rcsPrdType
			   	
		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' then A.TMPLT_INFO ->> '$[0].callback'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' then A.TMPLT_INFO ->> '$[1].callback'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' then A.TMPLT_INFO ->> '$[2].callback'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' then A.TMPLT_INFO ->> '$[3].callback'
			        	 ELSE ''
			   	END AS rcsCallback

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' then A.TMPLT_INFO ->> '$[0].messagebaseId'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' then A.TMPLT_INFO ->> '$[1].messagebaseId'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' then A.TMPLT_INFO ->> '$[2].messagebaseId'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' then A.TMPLT_INFO ->> '$[3].messagebaseId'
			        	 ELSE ''
			   	END AS rcsMessageBaseId			   	

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' then A.TMPLT_INFO ->> '$[0].footer'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' then A.TMPLT_INFO ->> '$[1].footer'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' then A.TMPLT_INFO ->> '$[2].footer'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' then A.TMPLT_INFO ->> '$[3].footer'
			        	 ELSE ''
			   	END AS rcsFooter

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[0].action.postback.data'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[0].action.postback.data'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[0].action.postback.data'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[0].action.postback.data'
			        	 ELSE ''
			   	END AS rcsButton0Data

		      , @rcsButton0ButtonType := 
		        CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[0].action.buttonType'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[0].action.buttonType'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[0].action.buttonType'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[0].action.buttonType'
			        	 ELSE ''
			   	END AS rcsButton0ButtonType 

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[0].action.displayText'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[0].action.displayText'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[0].action.displayText'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[0].action.displayText'
			        	 ELSE ''
			   	END AS rcsButton0DisplayText 
			   	
              , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' and @rcsButton0ButtonType = 'S' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[0].action.calendarAction.createCalendarEvent.title'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' and @rcsButton0ButtonType = 'S' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[0].action.calendarAction.createCalendarEvent.title'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' and @rcsButton0ButtonType = 'S' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[0].action.calendarAction.createCalendarEvent.title'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' and @rcsButton0ButtonType = 'S' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[0].action.calendarAction.createCalendarEvent.title'
			        	 
			        	 WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' and @rcsButton0ButtonType = 'U' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[0].action.urlAction.openUrl.url'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' and @rcsButton0ButtonType = 'U' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[0].action.urlAction.openUrl.url'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' and @rcsButton0ButtonType = 'U' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[0].action.urlAction.openUrl.url'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' and @rcsButton0ButtonType = 'U' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[0].action.urlAction.openUrl.url'
			        	 
			        	 WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' and @rcsButton0ButtonType = 'C' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[0].action.clipboardAction.copyToClipboard.text'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' and @rcsButton0ButtonType = 'C' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[0].action.clipboardAction.copyToClipboard.text'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' and @rcsButton0ButtonType = 'C' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[0].action.clipboardAction.copyToClipboard.text'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' and @rcsButton0ButtonType = 'C' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[0].action.clipboardAction.copyToClipboard.text'
			        	 
			        	 WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' and @rcsButton0ButtonType = 'T' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[0].action.dialerAction.dialPhoneNumber.phoneNumber'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' and @rcsButton0ButtonType = 'T' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[0].action.dialerAction.dialPhoneNumber.phoneNumber'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' and @rcsButton0ButtonType = 'T' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[0].action.dialerAction.dialPhoneNumber.phoneNumber'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' and @rcsButton0ButtonType = 'T' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[0].action.dialerAction.dialPhoneNumber.phoneNumber'
			        	 
			        	 WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' and @rcsButton0ButtonType = 'M' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[0].action.mapAction.requestLocationPush.url'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' and @rcsButton0ButtonType = 'M' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[0].action.mapAction.requestLocationPush.url'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' and @rcsButton0ButtonType = 'M' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[0].action.mapAction.requestLocationPush.url'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' and @rcsButton0ButtonType = 'M' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[0].action.mapAction.requestLocationPush.url'
						 ELSE ''
			   	END AS rcsButton0Title	
										   	

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[0].action.calendarAction.createCalendarEvent.startTime'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[0].action.calendarAction.createCalendarEvent.startTime'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[0].action.calendarAction.createCalendarEvent.startTime'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[0].action.calendarAction.createCalendarEvent.startTime'
			        	 ELSE ''
			   	END AS rcsButton0StartTime   

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[0].action.calendarAction.createCalendarEvent.endTime'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[0].action.calendarAction.createCalendarEvent.endTime'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[0].action.calendarAction.createCalendarEvent.endTime'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[0].action.calendarAction.createCalendarEvent.endTime'
			        	 ELSE ''
			   	END AS rcsButton0EndTime   

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[0].action.calendarAction.createCalendarEvent.description'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[0].action.calendarAction.createCalendarEvent.description'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[0].action.calendarAction.createCalendarEvent.description'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[0].action.calendarAction.createCalendarEvent.description'
			        	 ELSE ''
			   	END AS rcsButton0Description  

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[1].action.postback.data'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[1].action.postback.data'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[1].action.postback.data'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[1].action.postback.data'
			        	 ELSE ''
			   	END AS rcsButton1Data

		      , @rcsButton1ButtonType := 
				  CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[1].action.buttonType'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[1].action.buttonType'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[1].action.buttonType'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[1].action.buttonType'
			        	 ELSE ''
			   	END AS rcsButton1ButtonType  
			   	
		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[1].action.displayText'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[1].action.displayText'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[1].action.displayText'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[1].action.displayText'
			        	 ELSE ''
			   	END AS rcsButton1DisplayText

              , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' and @rcsButton1ButtonType = 'S' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[1].action.calendarAction.createCalendarEvent.title'
		  	        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' and @rcsButton1ButtonType = 'S' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[1].action.calendarAction.createCalendarEvent.title'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' and @rcsButton1ButtonType = 'S' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[1].action.calendarAction.createCalendarEvent.title'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' and @rcsButton1ButtonType = 'S' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[1].action.calendarAction.createCalendarEvent.title'
			        	 
			        	 WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' and @rcsButton1ButtonType = 'U' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[1].action.urlAction.openUrl.url'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' and @rcsButton1ButtonType = 'U' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[1].action.urlAction.openUrl.url'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' and @rcsButton1ButtonType = 'U' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[1].action.urlAction.openUrl.url'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' and @rcsButton1ButtonType = 'U' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[1].action.urlAction.openUrl.url'
			        	 
			        	 WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' and @rcsButton1ButtonType = 'C' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[1].action.clipboardAction.copyToClipboard.text'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' and @rcsButton1ButtonType = 'C' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[1].action.clipboardAction.copyToClipboard.text'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' and @rcsButton1ButtonType = 'C' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[1].action.clipboardAction.copyToClipboard.text'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' and @rcsButton1ButtonType = 'C' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[1].action.clipboardAction.copyToClipboard.text'
			        	 
			        	 WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' and @rcsButton1ButtonType = 'T' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[1].action.dialerAction.dialPhoneNumber.phoneNumber'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' and @rcsButton1ButtonType = 'T' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[1].action.dialerAction.dialPhoneNumber.phoneNumber'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' and @rcsButton1ButtonType = 'T' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[1].action.dialerAction.dialPhoneNumber.phoneNumber'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' and @rcsButton1ButtonType = 'T' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[1].action.dialerAction.dialPhoneNumber.phoneNumber'
			        	 
			        	 WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' and @rcsButton1ButtonType = 'M' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[1].action.mapAction.requestLocationPush.url'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' and @rcsButton1ButtonType = 'M' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[1].action.mapAction.requestLocationPush.url'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' and @rcsButton1ButtonType = 'M' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[1].action.mapAction.requestLocationPush.url'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' and @rcsButton1ButtonType = 'M' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[1].action.mapAction.requestLocationPush.url'
			        	 ELSE ''
			   	END AS rcsButton1Title

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[1].action.calendarAction.createCalendarEvent.startTime'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[1].action.calendarAction.createCalendarEvent.startTime'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[1].action.calendarAction.createCalendarEvent.startTime'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[1].action.calendarAction.createCalendarEvent.startTime'
			        	 ELSE ''
			   	END AS rcsButton1StartTime

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[1].action.calendarAction.createCalendarEvent.endTime'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[1].action.calendarAction.createCalendarEvent.endTime'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[1].action.calendarAction.createCalendarEvent.endTime'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[1].action.calendarAction.createCalendarEvent.endTime'
			        	 ELSE ''
			   	END AS rcsButton1EndTime

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[1].action.calendarAction.createCalendarEvent.description'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[1].action.calendarAction.createCalendarEvent.description'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[1].action.calendarAction.createCalendarEvent.description'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[1].action.calendarAction.createCalendarEvent.description'
			        	 ELSE ''
			   	END AS rcsButton1Description

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[2].action.postback.data'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[2].action.postback.data'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[2].action.postback.data'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[2].action.postback.data'
			        	 ELSE ''
			   	END AS rcsButton2Data

		      , @rcsButton2ButtonType := 
				  CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[2].action.buttonType'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[2].action.buttonType'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[2].action.buttonType'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[2].action.buttonType'
			        	 ELSE ''
			   	END AS rcsButton2ButtonType 
			   	
		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[2].action.displayText'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[2].action.displayText'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[2].action.displayText'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[2].action.displayText'
			        	 ELSE ''
			   	END AS rcsButton2DisplayText

              , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' and @rcsButton2ButtonType = 'S' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[2].action.calendarAction.createCalendarEvent.title'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' and @rcsButton2ButtonType = 'S' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[2].action.calendarAction.createCalendarEvent.title'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' and @rcsButton2ButtonType = 'S' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[2].action.calendarAction.createCalendarEvent.title'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' and @rcsButton2ButtonType = 'S' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[2].action.calendarAction.createCalendarEvent.title'
			        	 
			        	 WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' and @rcsButton2ButtonType = 'U' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[2].action.urlAction.openUrl.url'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' and @rcsButton2ButtonType = 'U' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[2].action.urlAction.openUrl.url'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' and @rcsButton2ButtonType = 'U' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[2].action.urlAction.openUrl.url'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' and @rcsButton2ButtonType = 'U' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[2].action.urlAction.openUrl.url'
			        	 
			        	 WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' and @rcsButton2ButtonType = 'C' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[2].action.clipboardAction.copyToClipboard.text'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' and @rcsButton2ButtonType = 'C' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[2].action.clipboardAction.copyToClipboard.text'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' and @rcsButton2ButtonType = 'C' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[2].action.clipboardAction.copyToClipboard.text'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' and @rcsButton2ButtonType = 'C' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[2].action.clipboardAction.copyToClipboard.text'
			        	 
			        	 WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' and @rcsButton2ButtonType = 'T' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[2].action.dialerAction.dialPhoneNumber.phoneNumber'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' and @rcsButton2ButtonType = 'T' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[2].action.dialerAction.dialPhoneNumber.phoneNumber'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' and @rcsButton2ButtonType = 'T' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[2].action.dialerAction.dialPhoneNumber.phoneNumber'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' and @rcsButton2ButtonType = 'T' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[2].action.dialerAction.dialPhoneNumber.phoneNumber'
			        	 
			        	 WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' and @rcsButton2ButtonType = 'M' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[2].action.mapAction.requestLocationPush.url'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' and @rcsButton2ButtonType = 'M' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[2].action.mapAction.requestLocationPush.url'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' and @rcsButton2ButtonType = 'M' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[2].action.mapAction.requestLocationPush.url'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' and @rcsButton2ButtonType = 'M' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[2].action.mapAction.requestLocationPush.url'
			        	 ELSE ''
			   	END AS rcsButton2Title

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[2].action.calendarAction.createCalendarEvent.startTime'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[2].action.calendarAction.createCalendarEvent.startTime'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[2].action.calendarAction.createCalendarEvent.startTime'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[2].action.calendarAction.createCalendarEvent.startTime'
			        	 ELSE ''
			   	END AS rcsButton2StartTime

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[2].action.calendarAction.createCalendarEvent.endTime'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[2].action.calendarAction.createCalendarEvent.endTime'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[2].action.calendarAction.createCalendarEvent.endTime'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[2].action.calendarAction.createCalendarEvent.endTime'
			        	 ELSE ''
			   	END AS rcsButton2EndTime

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[2].action.calendarAction.createCalendarEvent.description'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[2].action.calendarAction.createCalendarEvent.description'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[2].action.calendarAction.createCalendarEvent.description'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[2].action.calendarAction.createCalendarEvent.description'
			        	 ELSE ''
			   	END AS rcsButton2Description
			   	

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[3].action.postback.data'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[3].action.postback.data'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[3].action.postback.data'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[3].action.postback.data'
			        	 ELSE ''
			   	END AS rcsButton3Data

		      , @rcsButton3ButtonType := 
				  CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[3].action.buttonType'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[3].action.buttonType'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[3].action.buttonType'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[3].action.buttonType'
			        	 ELSE ''
			   	END AS rcsButton3ButtonType  
			   	
		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[3].action.displayText'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[3].action.displayText'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[3].action.displayText'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[3].action.displayText'
			        	 ELSE ''
			   	END AS rcsButton3DisplayText

              , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' and @rcsButton3ButtonType = 'S' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[3].action.calendarAction.createCalendarEvent.title'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' and @rcsButton3ButtonType = 'S' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[3].action.calendarAction.createCalendarEvent.title'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' and @rcsButton3ButtonType = 'S' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[3].action.calendarAction.createCalendarEvent.title'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' and @rcsButton3ButtonType = 'S' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[3].action.calendarAction.createCalendarEvent.title'
			        	 
			        	 WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' and @rcsButton3ButtonType = 'U' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[3].action.urlAction.openUrl.url'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' and @rcsButton3ButtonType = 'U' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[3].action.urlAction.openUrl.url'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' and @rcsButton3ButtonType = 'U' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[3].action.urlAction.openUrl.url'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' and @rcsButton3ButtonType = 'U' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[3].action.urlAction.openUrl.url'
			        	 
			        	 WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' and @rcsButton3ButtonType = 'C' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[3].action.clipboardAction.copyToClipboard.text'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' and @rcsButton3ButtonType = 'C' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[3].action.clipboardAction.copyToClipboard.text'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' and @rcsButton3ButtonType = 'C' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[3].action.clipboardAction.copyToClipboard.text'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' and @rcsButton3ButtonType = 'C' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[3].action.clipboardAction.copyToClipboard.text'
			        	 
			        	 WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' and @rcsButton3ButtonType = 'T' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[3].action.dialerAction.dialPhoneNumber.phoneNumber'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' and @rcsButton3ButtonType = 'T' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[3].action.dialerAction.dialPhoneNumber.phoneNumber'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' and @rcsButton3ButtonType = 'T' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[3].action.dialerAction.dialPhoneNumber.phoneNumber'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' and @rcsButton3ButtonType = 'T' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[3].action.dialerAction.dialPhoneNumber.phoneNumber'
			        	 
			        	 WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' and @rcsButton3ButtonType = 'M' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[3].action.mapAction.requestLocationPush.url'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' and @rcsButton3ButtonType = 'M' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[3].action.mapAction.requestLocationPush.url'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' and @rcsButton3ButtonType = 'M' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[3].action.mapAction.requestLocationPush.url'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' and @rcsButton3ButtonType = 'M' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[3].action.mapAction.requestLocationPush.url'
			        	 ELSE ''
			   	END AS rcsButton3Title

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[3].action.calendarAction.createCalendarEvent.startTime'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[3].action.calendarAction.createCalendarEvent.startTime'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[3].action.calendarAction.createCalendarEvent.startTime'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[3].action.calendarAction.createCalendarEvent.startTime'
			        	 ELSE ''
			   	END AS rcsButton3StartTime

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[3].action.calendarAction.createCalendarEvent.endTime'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[3].action.calendarAction.createCalendarEvent.endTime'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[3].action.calendarAction.createCalendarEvent.endTime'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[3].action.calendarAction.createCalendarEvent.endTime'
			        	 ELSE ''
			   	END AS rcsButton3EndTime

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[3].action.calendarAction.createCalendarEvent.description'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[3].action.calendarAction.createCalendarEvent.description'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[3].action.calendarAction.createCalendarEvent.description'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[3].action.calendarAction.createCalendarEvent.description'
			        	 ELSE ''
			   	END AS rcsButton3Description
			   	

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[4].action.postback.data'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[4].action.postback.data'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[4].action.postback.data'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[4].action.postback.data'
			        	 ELSE ''
			   	END AS rcsButton4Data

		      , @rcsButton4ButtonType :=
				  CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[4].action.buttonType'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[4].action.buttonType'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[4].action.buttonType'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[4].action.buttonType'
			        	 ELSE ''
			   	END AS rcsButton4ButtonType 
			   	
		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[4].action.displayText'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[4].action.displayText'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[4].action.displayText'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[4].action.displayText'
			        	 ELSE ''
			   	END AS rcsButton4DisplayText

              , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' and @rcsButton4ButtonType = 'S' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[4].action.calendarAction.createCalendarEvent.title'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' and @rcsButton4ButtonType = 'S' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[4].action.calendarAction.createCalendarEvent.title'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' and @rcsButton4ButtonType = 'S' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[4].action.calendarAction.createCalendarEvent.title'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' and @rcsButton4ButtonType = 'S' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[4].action.calendarAction.createCalendarEvent.title'
			        	 
			        	 WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' and @rcsButton4ButtonType = 'U' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[4].action.urlAction.openUrl.url'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' and @rcsButton4ButtonType = 'U' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[4].action.urlAction.openUrl.url'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' and @rcsButton4ButtonType = 'U' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[4].action.urlAction.openUrl.url'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' and @rcsButton4ButtonType = 'U' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[4].action.urlAction.openUrl.url'
			        	 
			        	 WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' and @rcsButton4ButtonType = 'C' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[4].action.clipboardAction.copyToClipboard.text'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' and @rcsButton4ButtonType = 'C' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[4].action.clipboardAction.copyToClipboard.text'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' and @rcsButton4ButtonType = 'C' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[4].action.clipboardAction.copyToClipboard.text'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' and @rcsButton4ButtonType = 'C' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[4].action.clipboardAction.copyToClipboard.text'
			        	 
			        	 WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' and @rcsButton4ButtonType = 'T' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[4].action.dialerAction.dialPhoneNumber.phoneNumber'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' and @rcsButton4ButtonType = 'T' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[4].action.dialerAction.dialPhoneNumber.phoneNumber'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' and @rcsButton4ButtonType = 'T' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[4].action.dialerAction.dialPhoneNumber.phoneNumber'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' and @rcsButton4ButtonType = 'T' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[4].action.dialerAction.dialPhoneNumber.phoneNumber'
			        	 
			        	 WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' and @rcsButton4ButtonType = 'M' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[4].action.mapAction.requestLocationPush.url'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' and @rcsButton4ButtonType = 'M' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[4].action.mapAction.requestLocationPush.url'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' and @rcsButton4ButtonType = 'M' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[4].action.mapAction.requestLocationPush.url'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' and @rcsButton4ButtonType = 'M' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[4].action.mapAction.requestLocationPush.url'
			        	 ELSE ''
			   	END AS rcsButton4Title

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[4].action.calendarAction.createCalendarEvent.startTime'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[4].action.calendarAction.createCalendarEvent.startTime'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[4].action.calendarAction.createCalendarEvent.startTime'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[4].action.calendarAction.createCalendarEvent.startTime'
			        	 ELSE ''
			   	END AS rcsButton4StartTime

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[4].action.calendarAction.createCalendarEvent.endTime'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[4].action.calendarAction.createCalendarEvent.endTime'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[4].action.calendarAction.createCalendarEvent.endTime'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[4].action.calendarAction.createCalendarEvent.endTime'
			        	 ELSE ''
			   	END AS rcsButton4EndTime

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[4].action.calendarAction.createCalendarEvent.description'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[4].action.calendarAction.createCalendarEvent.description'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[4].action.calendarAction.createCalendarEvent.description'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[4].action.calendarAction.createCalendarEvent.description'
			        	 ELSE ''
			   	END AS rcsButton4Description			   	

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[5].action.postback.data'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[5].action.postback.data'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[5].action.postback.data'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[5].action.postback.data'
			        	 ELSE ''
			   	END AS rcsButton5Data

		      , @rcsButton5ButtonType := 
				  CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[5].action.buttonType'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[5].action.buttonType'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[5].action.buttonType'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[5].action.buttonType'
			        	 ELSE ''
			   	END AS rcsButton5ButtonType 
			   	
		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[5].action.displayText'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[5].action.displayText'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[5].action.displayText'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[5].action.displayText'
			        	 ELSE ''
			   	END AS rcsButton5DisplayText

              , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' and @rcsButton5ButtonType = 'S' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[5].action.calendarAction.createCalendarEvent.title'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' and @rcsButton5ButtonType = 'S' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[5].action.calendarAction.createCalendarEvent.title'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' and @rcsButton5ButtonType = 'S' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[5].action.calendarAction.createCalendarEvent.title'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' and @rcsButton5ButtonType = 'S' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[5].action.calendarAction.createCalendarEvent.title'
			        	 
			        	 WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' and @rcsButton5ButtonType = 'U' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[5].action.urlAction.openUrl.url'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' and @rcsButton5ButtonType = 'U' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[5].action.urlAction.openUrl.url'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' and @rcsButton5ButtonType = 'U' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[5].action.urlAction.openUrl.url'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' and @rcsButton5ButtonType = 'U' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[5].action.urlAction.openUrl.url'
			        	 
			        	 WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' and @rcsButton5ButtonType = 'C' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[5].action.clipboardAction.copyToClipboard.text'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' and @rcsButton5ButtonType = 'C' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[5].action.clipboardAction.copyToClipboard.text'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' and @rcsButton5ButtonType = 'C' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[5].action.clipboardAction.copyToClipboard.text'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' and @rcsButton5ButtonType = 'C' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[5].action.clipboardAction.copyToClipboard.text'
			        	 
			        	 WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' and @rcsButton5ButtonType = 'T' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[5].action.dialerAction.dialPhoneNumber.phoneNumber'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' and @rcsButton5ButtonType = 'T' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[5].action.dialerAction.dialPhoneNumber.phoneNumber'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' and @rcsButton5ButtonType = 'T' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[5].action.dialerAction.dialPhoneNumber.phoneNumber'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' and @rcsButton5ButtonType = 'T' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[5].action.dialerAction.dialPhoneNumber.phoneNumber'
			        	 
			        	 WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' and @rcsButton5ButtonType = 'M' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[5].action.mapAction.requestLocationPush.url'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' and @rcsButton5ButtonType = 'M' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[5].action.mapAction.requestLocationPush.url'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' and @rcsButton5ButtonType = 'M' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[5].action.mapAction.requestLocationPush.url'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' and @rcsButton5ButtonType = 'M' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[5].action.mapAction.requestLocationPush.url'
			        	 ELSE ''
			   	END AS rcsButton5Title

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[5].action.calendarAction.createCalendarEvent.startTime'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[5].action.calendarAction.createCalendarEvent.startTime'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[5].action.calendarAction.createCalendarEvent.startTime'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[5].action.calendarAction.createCalendarEvent.startTime'
			        	 ELSE ''
			   	END AS rcsButton5StartTime

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[5].action.calendarAction.createCalendarEvent.endTime'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[5].action.calendarAction.createCalendarEvent.endTime'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[5].action.calendarAction.createCalendarEvent.endTime'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[5].action.calendarAction.createCalendarEvent.endTime'
			        	 ELSE ''
			   	END AS rcsButton5EndTime

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'rcs' then A.TMPLT_INFO ->> '$[0].body[0].suggestions[5].action.calendarAction.createCalendarEvent.description'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'rcs' then A.TMPLT_INFO ->> '$[1].body[0].suggestions[5].action.calendarAction.createCalendarEvent.description'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'rcs' then A.TMPLT_INFO ->> '$[2].body[0].suggestions[5].action.calendarAction.createCalendarEvent.description'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'rcs' then A.TMPLT_INFO ->> '$[3].body[0].suggestions[5].action.calendarAction.createCalendarEvent.description'
			        	 ELSE ''
			   	END AS rcsButton5Description		
			   	

			  , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[0].friendtalk.senderKey'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[1].friendtalk.senderKey'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[2].friendtalk.senderKey'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[3].friendtalk.senderKey'
			        	 ELSE ''
			   	END AS friendTalkSenderKey		   	

			  , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[0].friendtalk.wideImageYn'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[1].friendtalk.wideImageYn'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[2].friendtalk.wideImageYn'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[3].friendtalk.wideImageYn'
			        	 ELSE ''
			   	END AS friendTalkWideImageYn	

			  , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[0].friendtalk.msg'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[1].friendtalk.msg'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[2].friendtalk.msg'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[3].friendtalk.msg'
			        	 ELSE ''
			   	END AS friendTalkContent

			  , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[0].friendtalk.fileId'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[1].friendtalk.fileId'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[2].friendtalk.fileId'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[3].friendtalk.fileId'
			        	 ELSE ''
			   	END AS friendTalkFileId			   	

			, CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[0].friendtalk.image.imageUrl'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[1].friendtalk.image.imageUrl'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[2].friendtalk.image.imageUrl'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[3].friendtalk.image.imageUrl'
			        	 ELSE ''
			   	END AS friendTalkImgUrl	

			 , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[0].friendtalk.image.imageLink'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[1].friendtalk.image.imageLink'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[2].friendtalk.image.imageLink'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[3].friendtalk.image.imageLink'
			        	 ELSE ''
			   	END AS friendTalkImageLink

		      , @friendTalkButton0ButtonType := 
				   CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[0].action.buttonType'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[0].action.buttonType'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[0].action.buttonType'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[0].action.buttonType'
			        	 ELSE ''
			   	END AS friendTalkButton0ButtonType  

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[0].action.displayText'
		             WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[0].action.displayText'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[0].action.displayText'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[0].action.displayText'
			        	 ELSE ''
			   	END AS friendTalkButton0DisplayText  

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' and @friendTalkButton0ButtonType = 'S' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[0].action.calendarAction.createCalendarEvent.title'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' and @friendTalkButton0ButtonType = 'S' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[0].action.calendarAction.createCalendarEvent.title'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' and @friendTalkButton0ButtonType = 'S' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[0].action.calendarAction.createCalendarEvent.title'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' and @friendTalkButton0ButtonType = 'S' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[0].action.calendarAction.createCalendarEvent.title'
			        	 
			        	 WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' and @friendTalkButton0ButtonType = 'U' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[0].action.urlAction.openUrl.url'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' and @friendTalkButton0ButtonType = 'U' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[0].action.urlAction.openUrl.url'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' and @friendTalkButton0ButtonType = 'U' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[0].action.urlAction.openUrl.url'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' and @friendTalkButton0ButtonType = 'U' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[0].action.urlAction.openUrl.url'
			        	 
			        	 WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' and @friendTalkButton0ButtonType = 'C' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[0].action.clipboardAction.copyToClipboard.text'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' and @friendTalkButton0ButtonType = 'C' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[0].action.clipboardAction.copyToClipboard.text'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' and @friendTalkButton0ButtonType = 'C' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[0].action.clipboardAction.copyToClipboard.text'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' and @friendTalkButton0ButtonType = 'C' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[0].action.clipboardAction.copyToClipboard.text'
			        	 
			        	 WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' and @friendTalkButton0ButtonType = 'T' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[0].action.dialerAction.dialPhoneNumber.phoneNumber'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' and @friendTalkButton0ButtonType = 'T' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[0].action.dialerAction.dialPhoneNumber.phoneNumber'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' and @friendTalkButton0ButtonType = 'T' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[0].action.dialerAction.dialPhoneNumber.phoneNumber'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' and @friendTalkButton0ButtonType = 'T' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[0].action.dialerAction.dialPhoneNumber.phoneNumber'
			        	 
			        	 WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' and @friendTalkButton0ButtonType = 'M' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[0].action.mapAction.requestLocationPush.url'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' and @friendTalkButton0ButtonType = 'M' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[0].action.mapAction.requestLocationPush.url'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' and @friendTalkButton0ButtonType = 'M' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[0].action.mapAction.requestLocationPush.url'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' and @friendTalkButton0ButtonType = 'M' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[0].action.mapAction.requestLocationPush.url'
			        	 
			        	 ELSE ''
			   	END AS friendTalkButton0Title  

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[0].action.calendarAction.createCalendarEvent.startTime'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[0].action.calendarAction.createCalendarEvent.startTime'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[0].action.calendarAction.createCalendarEvent.startTime'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[0].action.calendarAction.createCalendarEvent.startTime'
			        	 ELSE ''
			   	END AS friendTalkButton0StartTime  

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[0].action.calendarAction.createCalendarEvent.endTime'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[0].action.calendarAction.createCalendarEvent.endTime'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[0].action.calendarAction.createCalendarEvent.endTime'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[0].action.calendarAction.createCalendarEvent.endTime'
			        	 ELSE ''
			   	END AS friendTalkButton0EndTime  

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[0].action.calendarAction.createCalendarEvent.description'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[0].action.calendarAction.createCalendarEvent.description'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[0].action.calendarAction.createCalendarEvent.description'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[0].action.calendarAction.createCalendarEvent.description'
			        	 ELSE ''
			   	END AS friendTalkButton0Description  

		      , @friendTalkButton1ButtonType := 
				  CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[1].action.buttonType'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[1].action.buttonType'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[1].action.buttonType'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[1].action.buttonType'
			        	 ELSE ''
			   	END AS friendTalkButton1ButtonType 

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[1].action.displayText'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[1].action.displayText'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[1].action.displayText'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[1].action.displayText'
			        	 ELSE ''
			   	END AS friendTalkButton1DisplayText 

           , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' and @friendTalkButton1ButtonType = 'S' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[1].action.calendarAction.createCalendarEvent.title'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' and @friendTalkButton1ButtonType = 'S' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[1].action.calendarAction.createCalendarEvent.title'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' and @friendTalkButton1ButtonType = 'S' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[1].action.calendarAction.createCalendarEvent.title'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' and @friendTalkButton1ButtonType = 'S' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[1].action.calendarAction.createCalendarEvent.title'
			        	 
			        	 WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' and @friendTalkButton1ButtonType = 'U' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[1].action.urlAction.openUrl.url'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' and @friendTalkButton1ButtonType = 'U' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[1].action.urlAction.openUrl.url'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' and @friendTalkButton1ButtonType = 'U' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[1].action.urlAction.openUrl.url'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' and @friendTalkButton1ButtonType = 'U' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[1].action.urlAction.openUrl.url'
			        	 
			        	 WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' and @friendTalkButton1ButtonType = 'C' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[1].action.clipboardAction.copyToClipboard.text'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' and @friendTalkButton1ButtonType = 'C' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[1].action.clipboardAction.copyToClipboard.text'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' and @friendTalkButton1ButtonType = 'C' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[1].action.clipboardAction.copyToClipboard.text'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' and @friendTalkButton1ButtonType = 'C' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[1].action.clipboardAction.copyToClipboard.text'
			        	 
			        	 WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' and @friendTalkButton1ButtonType = 'T' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[1].action.dialerAction.dialPhoneNumber.phoneNumber'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' and @friendTalkButton1ButtonType = 'T' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[1].action.dialerAction.dialPhoneNumber.phoneNumber'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' and @friendTalkButton1ButtonType = 'T' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[1].action.dialerAction.dialPhoneNumber.phoneNumber'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' and @friendTalkButton1ButtonType = 'T' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[1].action.dialerAction.dialPhoneNumber.phoneNumber'
			        	 
			        	 WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' and @friendTalkButton1ButtonType = 'M' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[1].action.mapAction.requestLocationPush.url'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' and @friendTalkButton1ButtonType = 'M' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[1].action.mapAction.requestLocationPush.url'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' and @friendTalkButton1ButtonType = 'M' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[1].action.mapAction.requestLocationPush.url'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' and @friendTalkButton1ButtonType = 'M' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[1].action.mapAction.requestLocationPush.url'
			        	 
			        	 ELSE ''
			   	END AS friendTalkButton1Title  			   	

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[1].action.calendarAction.createCalendarEvent.startTime'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[1].action.calendarAction.createCalendarEvent.startTime'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[1].action.calendarAction.createCalendarEvent.startTime'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[1].action.calendarAction.createCalendarEvent.startTime'
			        	 ELSE ''
			   	END AS friendTalkButton1StartTime  

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[1].action.calendarAction.createCalendarEvent.endTime'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[1].action.calendarAction.createCalendarEvent.endTime'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[1].action.calendarAction.createCalendarEvent.endTime'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[1].action.calendarAction.createCalendarEvent.endTime'
			        	 ELSE ''
			   	END AS friendTalkButton1EndTime   

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[1].action.calendarAction.createCalendarEvent.description'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[1].action.calendarAction.createCalendarEvent.description'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[1].action.calendarAction.createCalendarEvent.description'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[1].action.calendarAction.createCalendarEvent.description'
			        	 ELSE ''
			   	END AS friendTalkButton1Description  

		      , @friendTalkButton2ButtonType := 
				   CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[2].action.buttonType'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[2].action.buttonType'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[2].action.buttonType'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[2].action.buttonType'
			        	 ELSE ''
			   	END AS friendTalkButton2ButtonType 

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[2].action.displayText'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[2].action.displayText'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[2].action.displayText'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[2].action.displayText'
			        	 ELSE ''
			   	END AS friendTalkButton2DisplayText  

           , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' and @friendTalkButton2ButtonType = 'S' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[2].action.calendarAction.createCalendarEvent.title'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' and @friendTalkButton2ButtonType = 'S' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[2].action.calendarAction.createCalendarEvent.title'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' and @friendTalkButton2ButtonType = 'S' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[2].action.calendarAction.createCalendarEvent.title'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' and @friendTalkButton2ButtonType = 'S' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[2].action.calendarAction.createCalendarEvent.title'
			        	 
			        	 WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' and @friendTalkButton2ButtonType = 'U' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[2].action.urlAction.openUrl.url'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' and @friendTalkButton2ButtonType = 'U' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[2].action.urlAction.openUrl.url'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' and @friendTalkButton2ButtonType = 'U' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[2].action.urlAction.openUrl.url'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' and @friendTalkButton2ButtonType = 'U' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[2].action.urlAction.openUrl.url'
			        	 
			        	 WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' and @friendTalkButton2ButtonType = 'C' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[2].action.clipboardAction.copyToClipboard.text'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' and @friendTalkButton2ButtonType = 'C' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[2].action.clipboardAction.copyToClipboard.text'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' and @friendTalkButton2ButtonType = 'C' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[2].action.clipboardAction.copyToClipboard.text'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' and @friendTalkButton2ButtonType = 'C' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[2].action.clipboardAction.copyToClipboard.text'
			        	 
			        	 WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' and @friendTalkButton2ButtonType = 'T' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[2].action.dialerAction.dialPhoneNumber.phoneNumber'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' and @friendTalkButton2ButtonType = 'T' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[2].action.dialerAction.dialPhoneNumber.phoneNumber'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' and @friendTalkButton2ButtonType = 'T' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[2].action.dialerAction.dialPhoneNumber.phoneNumber'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' and @friendTalkButton2ButtonType = 'T' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[2].action.dialerAction.dialPhoneNumber.phoneNumber'
			        	 
			        	 WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' and @friendTalkButton2ButtonType = 'M' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[2].action.mapAction.requestLocationPush.url'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' and @friendTalkButton2ButtonType = 'M' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[2].action.mapAction.requestLocationPush.url'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' and @friendTalkButton2ButtonType = 'M' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[2].action.mapAction.requestLocationPush.url'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' and @friendTalkButton2ButtonType = 'M' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[2].action.mapAction.requestLocationPush.url'
			        	 
			        	 ELSE ''
			   	END AS friendTalkButton2Title  			   	
 

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[2].action.calendarAction.createCalendarEvent.startTime'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[2].action.calendarAction.createCalendarEvent.startTime'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[2].action.calendarAction.createCalendarEvent.startTime'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[2].action.calendarAction.createCalendarEvent.startTime'
			        	 ELSE ''
			   	END AS friendTalkButton2StartTime 

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[2].action.calendarAction.createCalendarEvent.endTime'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[2].action.calendarAction.createCalendarEvent.endTime'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[2].action.calendarAction.createCalendarEvent.endTime'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[2].action.calendarAction.createCalendarEvent.endTime'
			        	 ELSE ''
			   	END AS friendTalkButton2EndTime  

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[2].action.calendarAction.createCalendarEvent.description'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[2].action.calendarAction.createCalendarEvent.description'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[2].action.calendarAction.createCalendarEvent.description'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[2].action.calendarAction.createCalendarEvent.description'
			        	 ELSE ''
			   	END AS friendTalkButton2Description   

		      , @friendTalkButton3ButtonType := 
				   CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[3].action.buttonType'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[3].action.buttonType'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[3].action.buttonType'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[3].action.buttonType'
			        	 ELSE ''
			   	END AS friendTalkButton3ButtonType

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons.suggestions[3].action.displayText'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons.suggestions[3].action.displayText'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons.suggestions[3].action.displayText'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons.suggestions[3].action.displayText'
			        	 ELSE ''
			   	END AS friendTalkButton3DisplayText 

           , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' and @friendTalkButton3ButtonType = 'S' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[3].action.calendarAction.createCalendarEvent.title'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' and @friendTalkButton3ButtonType = 'S' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[3].action.calendarAction.createCalendarEvent.title'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' and @friendTalkButton3ButtonType = 'S' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[3].action.calendarAction.createCalendarEvent.title'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' and @friendTalkButton3ButtonType = 'S' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[3].action.calendarAction.createCalendarEvent.title'
			        	 
			        	 WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' and @friendTalkButton3ButtonType = 'U' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[3].action.urlAction.openUrl.url'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' and @friendTalkButton3ButtonType = 'U' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[3].action.urlAction.openUrl.url'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' and @friendTalkButton3ButtonType = 'U' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[3].action.urlAction.openUrl.url'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' and @friendTalkButton3ButtonType = 'U' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[3].action.urlAction.openUrl.url'
			        	 
			        	 WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' and @friendTalkButton3ButtonType = 'C' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[3].action.clipboardAction.copyToClipboard.text'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' and @friendTalkButton3ButtonType = 'C' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[3].action.clipboardAction.copyToClipboard.text'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' and @friendTalkButton3ButtonType = 'C' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[3].action.clipboardAction.copyToClipboard.text'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' and @friendTalkButton3ButtonType = 'C' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[3].action.clipboardAction.copyToClipboard.text'
			        	 
			        	 WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' and @friendTalkButton3ButtonType = 'T' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[3].action.dialerAction.dialPhoneNumber.phoneNumber'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' and @friendTalkButton3ButtonType = 'T' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[3].action.dialerAction.dialPhoneNumber.phoneNumber'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' and @friendTalkButton3ButtonType = 'T' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[3].action.dialerAction.dialPhoneNumber.phoneNumber'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' and @friendTalkButton3ButtonType = 'T' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[3].action.dialerAction.dialPhoneNumber.phoneNumber'
			        	 
			        	 WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' and @friendTalkButton3ButtonType = 'M' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[3].action.mapAction.requestLocationPush.url'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' and @friendTalkButton3ButtonType = 'M' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[3].action.mapAction.requestLocationPush.url'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' and @friendTalkButton3ButtonType = 'M' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[3].action.mapAction.requestLocationPush.url'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' and @friendTalkButton3ButtonType = 'M' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[3].action.mapAction.requestLocationPush.url'
			        	 
			        	 ELSE ''
			   	END AS friendTalkButton3Title  			   	


		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[3].action.calendarAction.createCalendarEvent.startTime'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[3].action.calendarAction.createCalendarEvent.startTime'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[3].action.calendarAction.createCalendarEvent.startTime'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[3].action.calendarAction.createCalendarEvent.startTime'
			        	 ELSE ''
			   	END AS friendTalkButton3StartTime  

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[3].action.calendarAction.createCalendarEvent.endTime'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[3].action.calendarAction.createCalendarEvent.endTime'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[3].action.calendarAction.createCalendarEvent.endTime'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[3].action.calendarAction.createCalendarEvent.endTime'
			        	 ELSE ''
			   	END AS friendTalkButton3EndTime   

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[3].action.calendarAction.createCalendarEvent.description'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[3].action.calendarAction.createCalendarEvent.description'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[3].action.calendarAction.createCalendarEvent.description'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[3].action.calendarAction.createCalendarEvent.description'
			        	 ELSE ''
			   	END AS friendTalkButton3Description 

		      , @friendTalkButton4ButtonType := 
				   CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[4].action.buttonType'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[4].action.buttonType'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[4].action.buttonType'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[4].action.buttonType'
			        	 ELSE ''
			   	END AS friendTalkButton4ButtonType 

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[4].action.displayText'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[4].action.displayText'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[4].action.displayText'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[4].action.displayText'
			        	 ELSE ''
			   	END AS friendTalkButton4DisplayText  

           , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' and @friendTalkButton4ButtonType = 'S' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[4].action.calendarAction.createCalendarEvent.title'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' and @friendTalkButton4ButtonType = 'S' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[4].action.calendarAction.createCalendarEvent.title'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' and @friendTalkButton4ButtonType = 'S' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[4].action.calendarAction.createCalendarEvent.title'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' and @friendTalkButton4ButtonType = 'S' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[4].action.calendarAction.createCalendarEvent.title'
			        	 
			        	 WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' and @friendTalkButton4ButtonType = 'U' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[4].action.urlAction.openUrl.url'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' and @friendTalkButton4ButtonType = 'U' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[4].action.urlAction.openUrl.url'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' and @friendTalkButton4ButtonType = 'U' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[4].action.urlAction.openUrl.url'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' and @friendTalkButton4ButtonType = 'U' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[4].action.urlAction.openUrl.url'
			        	 
			        	 WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' and @friendTalkButton4ButtonType = 'C' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[4].action.clipboardAction.copyToClipboard.text'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' and @friendTalkButton4ButtonType = 'C' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[4].action.clipboardAction.copyToClipboard.text'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' and @friendTalkButton4ButtonType = 'C' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[4].action.clipboardAction.copyToClipboard.text'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' and @friendTalkButton4ButtonType = 'C' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[4].action.clipboardAction.copyToClipboard.text'
			        	 
			        	 WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' and @friendTalkButton4ButtonType = 'T' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[4].action.dialerAction.dialPhoneNumber.phoneNumber'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' and @friendTalkButton4ButtonType = 'T' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[4].action.dialerAction.dialPhoneNumber.phoneNumber'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' and @friendTalkButton4ButtonType = 'T' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[4].action.dialerAction.dialPhoneNumber.phoneNumber'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' and @friendTalkButton4ButtonType = 'T' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[4].action.dialerAction.dialPhoneNumber.phoneNumber'
			        	 
			        	 WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' and @friendTalkButton4ButtonType = 'M' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[4].action.mapAction.requestLocationPush.url'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' and @friendTalkButton4ButtonType = 'M' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[4].action.mapAction.requestLocationPush.url'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' and @friendTalkButton4ButtonType = 'M' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[4].action.mapAction.requestLocationPush.url'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' and @friendTalkButton4ButtonType = 'M' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[4].action.mapAction.requestLocationPush.url'
			        	 
			        	 ELSE ''
			   	END AS friendTalkButton4Title  			   	


		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[4].action.calendarAction.createCalendarEvent.startTime'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[4].action.calendarAction.createCalendarEvent.startTime'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[4].action.calendarAction.createCalendarEvent.startTime'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[4].action.calendarAction.createCalendarEvent.startTime'
			        	 ELSE ''
			   	END AS friendTalkButton4StartTime  

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[4].action.calendarAction.createCalendarEvent.endTime'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[4].action.calendarAction.createCalendarEvent.endTime'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[4].action.calendarAction.createCalendarEvent.endTime'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[4].action.calendarAction.createCalendarEvent.endTime'
			        	 ELSE ''
			   	END AS friendTalkButton4EndTime  

		      , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[0].friendtalk.buttons[0].suggestions[4].action.calendarAction.createCalendarEvent.description'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[1].friendtalk.buttons[0].suggestions[4].action.calendarAction.createCalendarEvent.description'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[2].friendtalk.buttons[0].suggestions[4].action.calendarAction.createCalendarEvent.description'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'friendtalk' then A.TMPLT_INFO ->> '$[3].friendtalk.buttons[0].suggestions[4].action.calendarAction.createCalendarEvent.description'
			        	 ELSE ''
			   	END AS friendTalkButton4Description   	   				   	

			  , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'sms' then 'S' WHEN A.TMPLT_INFO ->> '$[0].chType' = 'mms' then 'M'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'sms' then 'S' WHEN A.TMPLT_INFO ->> '$[1].chType' = 'mms' then 'M'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'sms' then 'S' WHEN A.TMPLT_INFO ->> '$[2].chType' = 'mms' then 'M'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'sms' then 'S' WHEN A.TMPLT_INFO ->> '$[3].chType' = 'mms' then 'M'
			        	 ELSE ''
			   	END AS smsSendType

			  , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'sms' then A.TMPLT_INFO ->> '$[0].smsInfo.callback' WHEN A.TMPLT_INFO ->> '$[0].chType' = 'mms' then A.TMPLT_INFO ->> '$[0].mmsInfo.callback'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'sms' then A.TMPLT_INFO ->> '$[1].smsInfo.callback' WHEN A.TMPLT_INFO ->> '$[1].chType' = 'mms' then A.TMPLT_INFO ->> '$[1].mmsInfo.callback'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'sms' then A.TMPLT_INFO ->> '$[2].smsInfo.callback'  WHEN A.TMPLT_INFO ->> '$[2].chType' = 'mms' then A.TMPLT_INFO ->> '$[2].mmsInfo.callback'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'sms' then A.TMPLT_INFO ->> '$[3].smsInfo.callback' WHEN A.TMPLT_INFO ->> '$[3].chType' = 'mms' then A.TMPLT_INFO ->> '$[3].mmsInfo.callback'
			        	 ELSE ''
			   	END AS smsCallback	

			  , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'sms' then A.TMPLT_INFO ->> '$[0].smsInfo.msg' WHEN A.TMPLT_INFO ->> '$[0].chType' = 'mms' then A.TMPLT_INFO ->> '$[0].mmsInfo.msg'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'sms' then A.TMPLT_INFO ->> '$[1].smsInfo.msg' WHEN A.TMPLT_INFO ->> '$[1].chType' = 'mms' then A.TMPLT_INFO ->> '$[1].mmsInfo.msg'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'sms' then A.TMPLT_INFO ->> '$[2].smsInfo.msg' WHEN A.TMPLT_INFO ->> '$[2].chType' = 'mms' then A.TMPLT_INFO ->> '$[2].mmsInfo.msg'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'sms' then A.TMPLT_INFO ->> '$[3].smsInfo.msg' WHEN A.TMPLT_INFO ->> '$[3].chType' = 'mms' then A.TMPLT_INFO ->> '$[3].mmsInfo.msg'
			        	 ELSE ''
			   	END AS smsContent

			  , CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'mms' then A.TMPLT_INFO ->> '$[0].mmsInfo.title'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'mms' then A.TMPLT_INFO ->> '$[1].mmsInfo.title'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'mms' then A.TMPLT_INFO ->> '$[2].mmsInfo.title'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'mms' then A.TMPLT_INFO ->> '$[3].mmsInfo.title'
			        	 ELSE ''
			   	END AS smsTitle

			, CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'mms' then A.TMPLT_INFO ->> '$[0].mmsInfo.fileIdLst[0]'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'mms' then A.TMPLT_INFO ->> '$[1].mmsInfo.fileIdLst[0]'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'mms' then A.TMPLT_INFO ->> '$[2].mmsInfo.fileIdLst[0]'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'mms' then A.TMPLT_INFO ->> '$[3].mmsInfo.fileIdLst[0]'
			        	 ELSE ''
			   	END AS smsFileId0

			, CASE WHEN A.TMPLT_INFO ->> '$[0].chType' = 'mms' then A.TMPLT_INFO ->> '$[0].mmsInfo.fileIdLst[1]'
			        	 WHEN A.TMPLT_INFO ->> '$[1].chType' = 'mms' then A.TMPLT_INFO ->> '$[1].mmsInfo.fileIdLst[1]'
			        	 WHEN A.TMPLT_INFO ->> '$[2].chType' = 'mms' then A.TMPLT_INFO ->> '$[2].mmsInfo.fileIdLst[1]'
			        	 WHEN A.TMPLT_INFO ->> '$[3].chType' = 'mms' then A.TMPLT_INFO ->> '$[3].mmsInfo.fileIdLst[1]'
			        	 ELSE ''
			   	END AS smsFileId1
			   	
		FROM cm.CM_SMART_TMPLT A
		WHERE 1=1
		AND A.TMPLT_TYPE = 'M'
        AND A.TMPLT_CODE = #{tmpltCode}
) T LEFT OUTER JOIN cm_console.CM_IMAGE_FILE B ON T.pushFileId = B.FILE_ID    
	LEFT OUTER JOIN cm_console.CM_IMAGE_FILE sms0 ON T.smsFileId0 = sms0.FILE_ID
	LEFT OUTER JOIN cm_console.CM_IMAGE_FILE sms1 ON T.smsFileId1 = sms1.FILE_ID
    </select>
    
        
    <insert id="insertIntegratedTemplate" parameterType="hashmap">
    /* integraedtemplate.insertIntegratedTemplate - 통합 템플릿 등록 */
        INSERT
            INTO cm.CM_SMART_TMPLT
        (
            PROJECT_ID
            , TMPLT_CODE
            , MSG_KIND
            , MSG_TYPE
            , OTHER_PROJECT_USE_YN
			, TMPLT_TITLE
			, TMPLT_INFO
			, TMPLT_TYPE
			, TMPLT_STATUS
			, USE_YN
            , REG_DT
            , REG_ID
            , UPD_DT
            , UPD_ID
        ) VALUES (
            #{projectId}
            , #{tmpltCode}
            , #{msgKind}
            , #{msgType}
            , #{otherProjectUseYn}
            , #{tmpltTitle}
            , #{tmpltInfo}
            , #{tmpltType}
			, #{tmpltStatus}
			, #{useYn}
            , NOW()
            , #{userId}
            , NOW()
            , #{userId}
        )
        ON DUPLICATE KEY UPDATE MSG_KIND = #{msgKind}
					            , MSG_TYPE = #{msgType}
					            , OTHER_PROJECT_USE_YN = #{otherProjectUseYn}
					            , TMPLT_TITLE = #{tmpltTitle}
					            , TMPLT_INFO = #{tmpltInfo}
					            , TMPLT_TYPE = #{tmpltType}
					            , TMPLT_STATUS = #{tmpltStatus}
					            , USE_YN = #{useYn}
					            , UPD_DT = NOW()
					            , UPD_ID = #{userId}
    </insert>

    <update id="updateIntegratedTemplate" parameterType="hashmap">
    /* integraedtemplate.updateIntegratedTemplate - 통합 템플릿 수정 */
        UPDATE cm.CM_SMART_TMPLT
        SET
            MSG_KIND = #{msgKind}
            , MSG_TYPE = #{msgType}
            , OTHER_PROJECT_USE_YN = #{otherProjectUseYn}
            , TMPLT_TITLE = #{tmpltTitle}
            , TMPLT_INFO = #{tmpltInfo}
            , TMPLT_TYPE = #{tmpltType}
            , TMPLT_STATUS = #{tmpltStatus}
            , UPD_DT = NOW()
            , UPD_ID = #{userId}
        WHERE PROJECT_ID = #{projectId}
          AND TMPLT_CODE = #{tmpltCode}
    </update>
    

    <delete id="deleteIntegratedTemplate" parameterType="hashmap">
    /* integraedtemplate.deleteIntegratedTemplate - 통합 템플릿 삭제 */
        DELETE
        FROM cm.CM_SMART_TMPLT
        WHERE 1=1
		AND TMPLT_TYPE = 'M'
        AND TMPLT_CODE IN <foreach collection="tmpltCodes" item="item" index="index"  open="(" close=")" separator=",">#{item}</foreach>
    </delete>


</mapper>