<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="signUp">
	
	<select id="selectDomainChkCount" resultType="int">
		/* signUp.selectDomainChkCount */
		SELECT	COUNT(1)
		FROM	CM_CORP
		WHERE	DOMAIN_NAME = #{domainName}
	</select>

	<insert id="insertCmUser">
		/* signUp.insertCmUser */
		INSERT INTO CM_USER (
				USER_ID
		,		LOGIN_ID
		,		LOGIN_PWD
		,		PWD_UPD_DT
		,		HP_NUMBER
		,		APPROVAL_STATUS
		,		DEL_YN
		,		CORP_ID
		,		ROLE_CD
		,		REG_ID
		,		REG_DT
		) VALUES (
				#{userId}
		,		#{loginId}
		,		#{password}
		,		NOW()
		,		#{phoneCerti}
		,		'ING'
		,		'N'
		,		#{corpId}
		,		#{cmRole}
		,		#{userId}
		,		NOW()
		)
	</insert>

	<select id="selectCmUseTerms" resultType = "camel">
		/* signUp.selectCmUseTerms */
		SELECT	SVC_TERMS_ID
		,		TERMS_CONTENT
		FROM	cm_bo.CM_USE_TERMS
		WHERE	TERMS_CD = #{srcTermsCd}
		AND		USE_YN = 'Y'
		ORDER BY REG_DT DESC
		LIMIT 1
	</select>

	<select id="selectCmUseTermsPriVersion" resultType = "camel">
		/* signUp.selectCmUseTermsPriVersion */
		SELECT	SVC_TERMS_ID
		,		TERMS_CONTENT
		,		REVISE_DAY
		FROM	cm_bo.CM_USE_TERMS
		WHERE	TERMS_CD = #{srcTermsCd}
		AND		USE_YN = 'N'
		ORDER BY REVISE_DAY DESC
	</select>

	<insert id="insertCmCorp">
		/* signUp.insertCmCorp */
		INSERT INTO CM_CORP (
				CORP_ID
		,		CUST_NO
		,		CORP_NAME
		,		REGNO
		,		REG_ID
		,		REG_DT
		,		CEO_NAME
		,		ZIPCODE
		,		WOPLACE_ADDRESS
		,		WOPLACE_ADDRESS_DETAIL
		,		BUSITYPE
		,		BUSICLASS
		,		SMS_CERTIFY_YN
		,		WIRE_TEL
		,		FILE_ID
		,		DOMAIN_NAME
		) VALUES (
				#{corpId}
		,		#{custNo}
		,		#{corpNm}
		,		#{regno}
		,		#{userId}
		,		NOW()
		,		#{ceoNm}
		,		#{zipCode}
		,		#{woplaceAddress}
		,		#{woplaceAddressDetail}
		,		#{busiType}
		,		#{busiClass}
		,		#{smsCertifyYn}
		,		#{wireTel}
		,		#{fileId}
		,		#{domainName}
		)
	</insert>
	
	<select id="checkMailCertifyByLoginId" resultType="string">
		/* signUp.checkMailCertifyByLoginId */
		SELECT	COUNT(1)
		FROM	cm_console.CM_USER
		WHERE	LOGIN_ID = #{loginId}
		AND		MAIL_CERTIFY_NUMBER =#{authKey}
	</select>
</mapper>